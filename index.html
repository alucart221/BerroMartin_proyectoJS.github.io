<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <title>proto</title>
</head>

<style>
    #fondo{
    background-color: #5a97f2;
    }
    #formulario{
        background-color: #713deb;
    }
    header{
        background-color: #b2b4b8;
    }
    header img{
        width: 25%;
    }
    footer {
        background-color: #b2b4b8;
    }
    footer a {
      color: red; /* Example: blue text color */
      text-decoration: none; /* Removes the underline */
      font-weight: bold; /* Makes the text bold */
    }

</style>
<body id="fondo">

    <header class="d-flex justify-content-start gap-2"> 
        <a href="index.html"><img src="logo.png" alt="logo de la pagina"></a>
    </header>
    <article class="d-flex flex-column gap-4 justify-content-center" id="fondo">
        <div class="position-static d-flex flex-column flex-lg-row justify-content-center p-2 " >
            <form class="col-lg-3 flex-column d-flex flex-column gap-2  p-3 rounded-1"  id="formulario" data-bs-theme="dark"> 
                <input type="text" id = "nombre" placeholder="nombre" name="nombre" required>
                <input type="text" id = "email" placeholder="email" name="email">
                <input type="text" id = "asunto" placeholder="asunto" name="asunto" required>
                <textarea type="text" class="form-control myInput" id = "mensaje" placeholder="mensaje" name="mensaje" required rows="5"></textarea>
                <div id="html_element"></div>
                <div class="mb-3">
                    <div class="g-recaptcha" data-sitekey="6LdDavkrAAAAAGR4OQFmvhWGOwWkpoY0PQj7VWqc"></div>
                </div>
                <button class="btn btn-success px-3" type="submit">enviar</button>
            </form>
        </div>
    </article>
    <footer class="py-2 fixed-bottom"> 
        <div class="d-flex align-items-start gap-4 justify-content-center">
            <a href="https://ar.linkedin.com/in/martin-ignacio-berro-5b8049337?trk=people-guest_people_search-card" target="_blank">martin</a>
            <a href="https://es.wikipedia.org/wiki/Lionel_Messi" target="_blank">wikkipedia messi</a>
            <a href="https://homestuck.com/" target="_blank">homestuck</a>
        </div>
    </footer>

</body>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
<script src="https://www.google.com/recaptcha/api.js" async defer></script>

<script>

    const formulario = document.getElementById("formulario");
    const scriptURL = "https://script.google.com/macros/s/AKfycbx6lAyO1qPhIt-OE6qwKgwVb_dT_6dYVySdWjhmog2wMUsNc7ukf29l4iXD4C3vet1a/exec"; //URL de google sheets para macros

    formulario.addEventListener("submit", function(e) {

        e.preventDefault(); //funcion laamada a ejecutarse en la declarracion aplicada al metodo del formulario
        
        (function(){
            emailjs.init("9ZtAPPxMzYF7KPwIl");
        })(); //funccion llamada a la fuerza a ejecutarse sin declaraccion

        const nombre = document.getElementById("nombre").value.trim();
        const email = document.getElementById("email").value.trim();
        const asunto = document.getElementById("asunto").value.trim();
        const mensaje = document.getElementById("mensaje").value.trim();
        const recapcha_r = grecaptcha.getResponse();
        const matizEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; //contiene un conjunto de instrucciones basicas para asegurarse de que el campo correo contenga @ y .

        
        if(!matizEmail.test(email)){
            alert("Porfavor introduzca un correo valido.")
            
            return;
        }
        
        if(!recapcha_r){
            alert("Porfavor verifique que no es un bot.");
            
            return;
        }
        

        emailjs.send("service_zmmi2gd", "template_vapjuzb", {
            nombre : nombre,
            email : email,
            asunto : asunto,
            mensaje : mensaje
            }).then(function(response) {
            console.log("Correo enviado con Ã©xito", response.status, response.text);
            alert("nos contactaremos por mail");
            form.reset();
            grecaptcha.reset(); // resetea el captcha
            }, function(error) {
            console.error("Error al enviar", error);
            alert("error al enviar respuesta");
        });

        
        console.log(formulario);
        const datos_formulario = new FormData(formulario);

        fetch(scriptURL,{
             headers: {
            "Content-Type": "application/json",
            },
            method: "POST",
            body : datos_formulario,
            mode : "no-cors"
        });
    });

</script>

<!-- ZONA DE TESTEOS
    console.log(nombre + " " + email + " " + asunto + " " + mensaje + ".");

    alert(recapcha_r);

    console.log(matizEmail.test(email));

    console.log(mensaje);
-->

</html>
